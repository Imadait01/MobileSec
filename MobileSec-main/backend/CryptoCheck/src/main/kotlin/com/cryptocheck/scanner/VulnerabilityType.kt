package com.cryptocheck.scanner

/**
 * Enumération des types de vulnérabilités cryptographiques détectables.
 * 
 * Chaque type est associé à un CWE et une recommandation de correction.
 */
enum class VulnerabilityType(
    /**
     * Description de la vulnérabilité.
     */
    val description: String,
    
    /**
     * Identifiant CWE (Common Weakness Enumeration).
     */
    val cwe: String,
    
    /**
     * Recommandation pour corriger la vulnérabilité.
     */
    val recommendation: String
) {
    /**
     * Utilisation d'AES en mode ECB (non sécurisé).
     * CWE-327: Use of a Broken or Risky Cryptographic Algorithm
     */
    AES_ECB_USAGE(
        "AES/ECB usage",
        "CWE-327",
        "Remplacer AES/ECB par AES/GCM/NoPadding ou AES/CBC/PKCS5Padding avec un IV aléatoire"
    ),
    
    /**
     * Absence de padding dans l'utilisation d'AES.
     * CWE-327: Use of a Broken or Risky Cryptographic Algorithm
     */
    AES_NO_PADDING(
        "AES without proper padding",
        "CWE-327",
        "Utiliser un padding approprié (PKCS5Padding, PKCS7Padding) ou le mode GCM"
    ),
    
    /**
     * Utilisation d'un générateur aléatoire faible (Random au lieu de SecureRandom).
     * CWE-330: Use of Insufficiently Random Values
     */
    WEAK_RANDOM_GENERATOR(
        "Weak random generator (Random instead of SecureRandom)",
        "CWE-330",
        "Remplacer java.util.Random par java.security.SecureRandom pour les opérations cryptographiques"
    ),
    
    /**
     * Utilisation de MD5 (algorithme de hachage obsolète et vulnérable).
     * CWE-327: Use of a Broken or Risky Cryptographic Algorithm
     */
    MD5_USAGE(
        "MD5 hash usage (deprecated and vulnerable)",
        "CWE-327",
        "Remplacer MD5 par SHA-256, SHA-512, ou bcrypt/Argon2 pour les mots de passe"
    ),
    
    /**
     * Utilisation de SHA-1 (algorithme de hachage obsolète).
     * CWE-327: Use of a Broken or Risky Cryptographic Algorithm
     */
    SHA1_USAGE(
        "SHA-1 hash usage (deprecated)",
        "CWE-327",
        "Remplacer SHA-1 par SHA-256 ou SHA-512"
    ),
    
    /**
     * Utilisation de DES (algorithme de chiffrement obsolète et faible).
     * CWE-327: Use of a Broken or Risky Cryptographic Algorithm
     */
    DES_USAGE(
        "DES encryption usage (weak, deprecated)",
        "CWE-327",
        "Remplacer DES par AES-256 ou AES-128"
    ),
    
    /**
     * Clé cryptographique codée en dur dans le code source.
     * CWE-321: Use of Hard-coded Cryptographic Key
     */
    HARDCODED_KEY(
        "Hardcoded cryptographic key detected",
        "CWE-321",
        "Stocker les clés dans un système de gestion des secrets (KeyStore, Vault, etc.)"
    )
}

